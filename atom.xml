<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Eson Wong&#39;s Blog</title>
  <icon>https://www.gravatar.com/avatar/bb64ee8880e0f75605904ab137b75e19</icon>
  <subtitle>编程记录，心得分享</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.esonwong.com/"/>
  <updated>2020-02-07T03:32:23.803Z</updated>
  <id>https://blog.esonwong.com/</id>
  
  <author>
    <name>Eson Wong</name>
    <email>itiwll@gmail.com</email>
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Ecmascript 提案：空值合并运算符 &quot;??&quot; </title>
    <link href="https://blog.esonwong.com/2020/02/05/Ecmascript-%E6%8F%90%E6%A1%88-%E7%A9%BA%E5%80%BC%E5%90%88%E5%B9%B6%E8%BF%90%E7%AE%97%E7%AC%A6/"/>
    <id>https://blog.esonwong.com/2020/02/05/Ecmascript-%E6%8F%90%E6%A1%88-%E7%A9%BA%E5%80%BC%E5%90%88%E5%B9%B6%E8%BF%90%E7%AE%97%E7%AC%A6/</id>
    <published>2020-02-05T20:37:15.000Z</published>
    <updated>2020-02-07T03:32:23.803Z</updated>
    
    <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>如果控制合并运算符 <code>??</code> 左边的值为 <code>null</code> 或 <code>undefined</code> ，表达式会返回控制合并运算符右边的值，否则返回左边的值。</p><p>已经进入 stage 4(Finished) 阶段，等待加入标准。</p><p>示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">    name: <span class="string">"eson"</span>,</span><br><span class="line">    age: <span class="number">0</span>,</span><br><span class="line">    address: <span class="literal">null</span>,</span><br><span class="line">    gender: <span class="string">""</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> userName = user.name ?? <span class="string">"unknown"</span>; <span class="comment">// "eson"</span></span><br><span class="line"><span class="keyword">const</span> userAge = user.age ?? <span class="number">0</span>; <span class="comment">// 18</span></span><br><span class="line"><span class="keyword">const</span> userAddress = user.address ?? <span class="string">"unknown"</span>; <span class="comment">// "unknown"</span></span><br><span class="line"><span class="keyword">const</span> userGender = user.gender ?? <span class="string">"male"</span>; <span class="comment">// ""</span></span><br></pre></td></tr></table></figure><h2 id="作用和使用场景"><a href="#作用和使用场景" class="headerlink" title="作用和使用场景"></a>作用和使用场景</h2><p><code>??</code> 主要可以用来获取对象属性值时替代 <code>||</code> 来设定默认值。使用 <code>||</code> 时，如果 <code>||</code> 左边的值为 <code>0</code> 或者空字符串，表达仍然降返回右边的值.</p><p>如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> userAge = user.age || <span class="number">18</span>; <span class="comment">// 18</span></span><br><span class="line"><span class="keyword">const</span> userAddress = user.address || <span class="string">"unknown"</span>; <span class="comment">// "unknown"</span></span><br><span class="line"><span class="keyword">const</span> userGender = user.gender || <span class="string">"male"</span>; <span class="comment">// "male"</span></span><br></pre></td></tr></table></figure><h2 id="使用-bable-插件支持空值合并运算符"><a href="#使用-bable-插件支持空值合并运算符" class="headerlink" title="使用 bable 插件支持空值合并运算符"></a>使用 bable 插件支持空值合并运算符</h2><h3 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev @babel/plugin-proposal-nullish-coalescing-operator</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">yarn add @babel/plugin-proposal-nullish-coalescing-operator -D</span><br></pre></td></tr></table></figure><h3 id="babel-配置"><a href="#babel-配置" class="headerlink" title="babel 配置"></a>babel 配置</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"plugins"</span>: [<span class="string">"@babel/plugin-proposal-nullish-coalescing-operator"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://github.com/tc39/proposal-nullish-coalescing" target="_blank" rel="noopener">tc3/proposal-nullish-coalescing</a></li><li><a href="https://babeljs.io/docs/en/babel-plugin-proposal-nullish-coalescing-operator" target="_blank" rel="noopener">@babel/plugin-proposal-nullish-coalescing-operator</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;p&gt;如果控制合并运算符 &lt;code&gt;??&lt;/code&gt; 左边的值为 &lt;code&gt;null&lt;/code&gt; 或 &lt;code&gt;undefined&lt;/c
      
    
    </summary>
    
    
    
      <category term="+ 空值合并运算符 + nullish coalescing + &#39;??&#39; + babel + ECMAScript" scheme="https://blog.esonwong.com/tags/%E7%A9%BA%E5%80%BC%E5%90%88%E5%B9%B6%E8%BF%90%E7%AE%97%E7%AC%A6-nullish-coalescing-babel-ECMAScript/"/>
    
  </entry>
  
  <entry>
    <title>Ecmascript 提案：可选链 &quot;?.&quot; </title>
    <link href="https://blog.esonwong.com/2020/01/31/Ecmascript-%E6%8F%90%E6%A1%88%E5%8F%AF%E9%80%89%E9%93%BE/"/>
    <id>https://blog.esonwong.com/2020/01/31/Ecmascript-%E6%8F%90%E6%A1%88%E5%8F%AF%E9%80%89%E9%93%BE/</id>
    <published>2020-01-31T20:37:15.000Z</published>
    <updated>2020-02-07T03:32:23.803Z</updated>
    
    <content type="html"><![CDATA[<h2 id="可选链提案"><a href="#可选链提案" class="headerlink" title="可选链提案"></a>可选链提案</h2><p>可选链 Optional Chaining 是一项方便读取对象属性值的 ECMAScript 语法提案。它将检测将要读取属性所属的对象是否为 <code>null</code> 或者 <code>undefined</code>，如果是将会返回 <code>undefinde</code>, 另外也可调用方法时用作于检测方法是否存在，如果存在则执行。已经进入 stage 4(Finished) 阶段，等待加入标准。</p><p>示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123; <span class="attr">name</span>: <span class="string">"eson"</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> name = user?.name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> list = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">const</span> item0 = list?.[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> func = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line">func.?();</span><br></pre></td></tr></table></figure><h2 id="作用和使用场景"><a href="#作用和使用场景" class="headerlink" title="作用和使用场景"></a>作用和使用场景</h2><p>许多 API 或者后端接口返回的结果通常是一个 <code>object</code> 或者 <code>array</code>, 如果没有可用值则会返回 <code>null</code> 或 <code>undefined</code>， 通常只有结果不为 <code>null</code> 或 <code>undefined</code> 的时候我们才会去读取它的属性。<code>?.</code> 可以省去烦人的对象检测。</p><h2 id="使用-bable-插件支持可选链语法"><a href="#使用-bable-插件支持可选链语法" class="headerlink" title="使用 bable 插件支持可选链语法"></a>使用 bable 插件支持可选链语法</h2><p>现在通过 babel 的 proposal-optional-chaining 插件可以提前享用可选链语法。</p><h3 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev @babel/plugin-proposal-optional-chaining</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">yarn add @babel/plugin-proposal-optional-chaining -D</span><br></pre></td></tr></table></figure><h3 id="babel-配置"><a href="#babel-配置" class="headerlink" title="babel 配置"></a>babel 配置</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"plugins"</span>: [<span class="string">"@babel/plugin-proposal-optional-chaining"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><p><a href="https://github.com/tc39/proposal-optional-chaining" target="_blank" rel="noopener">tc39 / proposal-optional-chaining</a></p></li><li><p><a href="https://babeljs.io/docs/en/babel-plugin-proposal-optional-chaining" target="_blank" rel="noopener">@babel/plugin-proposal-optional-chaining</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;可选链提案&quot;&gt;&lt;a href=&quot;#可选链提案&quot; class=&quot;headerlink&quot; title=&quot;可选链提案&quot;&gt;&lt;/a&gt;可选链提案&lt;/h2&gt;&lt;p&gt;可选链 Optional Chaining 是一项方便读取对象属性值的 ECMAScript 语法提案。它将检测将要
      
    
    </summary>
    
    
    
      <category term="可选链" scheme="https://blog.esonwong.com/tags/%E5%8F%AF%E9%80%89%E9%93%BE/"/>
    
      <category term="optional chaining" scheme="https://blog.esonwong.com/tags/optional-chaining/"/>
    
      <category term="?." scheme="https://blog.esonwong.com/tags//"/>
    
      <category term="babel" scheme="https://blog.esonwong.com/tags/babel/"/>
    
      <category term="ECMAScript" scheme="https://blog.esonwong.com/tags/ECMAScript/"/>
    
  </entry>
  
  <entry>
    <title>怎么用 webpack 实现 js 模块按需懒加载？</title>
    <link href="https://blog.esonwong.com/2020/01/28/%E6%80%8E%E4%B9%88%E7%94%A8-webpack-%E5%AE%9E%E7%8E%B0-js-%E6%A8%A1%E5%9D%97%E6%8C%89%E9%9C%80%E6%87%92%E5%8A%A0%E8%BD%BD/"/>
    <id>https://blog.esonwong.com/2020/01/28/%E6%80%8E%E4%B9%88%E7%94%A8-webpack-%E5%AE%9E%E7%8E%B0-js-%E6%A8%A1%E5%9D%97%E6%8C%89%E9%9C%80%E6%87%92%E5%8A%A0%E8%BD%BD/</id>
    <published>2020-01-28T11:28:49.000Z</published>
    <updated>2020-02-07T03:32:23.803Z</updated>
    
    <content type="html"><![CDATA[<h2 id="动态导入，ECMAScript-import-提案"><a href="#动态导入，ECMAScript-import-提案" class="headerlink" title="动态导入，ECMAScript import() 提案"></a>动态导入，ECMAScript <code>import()</code> 提案</h2><p>ECMAScript 有一项允许使用 <code>import()</code> 方法传入 url 返回 <code>Promise</code> 动态导入 ES 模块的提案。已经进入 stage 4(Finished) 阶段，等待加入标准。</p><p>示例</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>(<span class="string">"https://cdn.jsdelivr.net/npm/vue@2.6.11/dist/vue.esm.browser.js"</span>)</span><br><span class="line">  .then(<span class="function"><span class="params">rep</span> =&gt;</span> &#123; </span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Vue'</span>,rep.default)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure><p>Webpack 提供了 <code>import()</code> 语法，但是 Webpack 并不支持网络模块的导入。 Webpack 可以以本地路径或项目中安装的模块名动态导入模块。</p><p>示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>(<span class="string">"./a.js"</span>) <span class="comment">// 本地路径</span></span><br><span class="line">  .then(<span class="function"><span class="params">rep</span> =&gt;</span> &#123; </span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Vue'</span>,rep.default)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span>(<span class="string">"vue"</span>) <span class="comment">// 安装的模块名</span></span><br><span class="line">  .then(<span class="function"><span class="params">rep</span> =&gt;</span> &#123; </span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'a'</span>,rep.default)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure><p><em>注： 使用 Webpack 的 <code>import()</code> 传递动态的本地 path 需要一些技巧</em></p><h2 id="Vue-Router"><a href="#Vue-Router" class="headerlink" title="Vue Router"></a>Vue Router</h2><p>Vue Router 配置的 component 属性支持传递一个返回 <code>Promise</code> 的方法，在匹配到路由准备渲染组件前会掉用此方法加载组件。</p><p>示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Foo = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'./Foo.vue'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123; <span class="attr">path</span>: <span class="string">'/foo'</span>, <span class="attr">component</span>: Foo &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="组件加载状态"><a href="#组件加载状态" class="headerlink" title="组件加载状态"></a>组件加载状态</h2><p>Vue 函数式组件的 <code>createElemnt</code> （即 <code>h</code>）方法的第一个参数支持传递一个指定异步渲染的组件、加载时渲染的组件和加载失败渲染的组件的对象。我们可以据此创建一个懒加载容器组件。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">lazyLoadView</span>(<span class="params">AsyncView</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> AsyncHandler = <span class="function"><span class="params">()</span> =&gt;</span> (&#123;</span><br><span class="line">    <span class="comment">// 需要加载的组件 (应该是一个 `Promise` 对象)</span></span><br><span class="line">    component: AsyncView,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 异步组件加载时使用的组件</span></span><br><span class="line">    loading: Loading,</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 加载失败时使用的组件</span></span><br><span class="line">    <span class="comment">// error: Error,</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 展示加载时组件的延时时间。默认值是 200 (毫秒)</span></span><br><span class="line">    delay: <span class="number">200</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果提供了超时时间且组件加载也超时了，</span></span><br><span class="line">    <span class="comment">// 则使用加载失败时使用的组件。默认值是：`Infinity`</span></span><br><span class="line">    timeout: <span class="number">10000</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    functional: <span class="literal">true</span>,</span><br><span class="line">    render(h, &#123; data, children &#125;) &#123;</span><br><span class="line">      <span class="keyword">return</span> h(AsyncHandler, data, children);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后修改路由配置：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">"/foo"</span>,</span><br><span class="line">      component: <span class="function"><span class="params">()</span> =&gt;</span></span><br><span class="line">        lazyLoadView(</span><br><span class="line">         <span class="keyword">import</span>(<span class="string">"./Foo.vue"</span>)</span><br><span class="line">          <span class="comment">// 模拟网络延迟</span></span><br><span class="line">          <span class="comment">// new Promise(resolve =&gt; &#123;</span></span><br><span class="line">          <span class="comment">//   window.setTimeout(rep =&gt; &#123;</span></span><br><span class="line">          <span class="comment">//     resolve(import("./Foo.vue"));</span></span><br><span class="line">          <span class="comment">//   &#125;, 5000);</span></span><br><span class="line">          <span class="comment">// &#125;)</span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="最终效果"><a href="#最终效果" class="headerlink" title="最终效果"></a>最终效果</h2><iframe     src="https://codesandbox.io/embed/vue-router-import-plws9?fontsize=14&hidenavigation=1&theme=dark"     style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;"     title="vue-router-import"     allow="geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb"     sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"   ></iframe><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://github.com/tc39/proposal-dynamic-import" target="_blank" rel="noopener">tc39/proposal-dynamic-import</a></li><li><a href="https://tc39.es/process-document/" target="_blank" rel="noopener">The TC39 Process</a></li><li><a href="https://router.vuejs.org/zh/guide/advanced/lazy-loading.html" target="_blank" rel="noopener">Vue Router - 路由懒加载</a></li><li><a href="https://juejin.im/post/5b90d0fcf265da0aa81bd728" target="_blank" rel="noopener">Vue异步组件处理路由组件加载状态</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;动态导入，ECMAScript-import-提案&quot;&gt;&lt;a href=&quot;#动态导入，ECMAScript-import-提案&quot; class=&quot;headerlink&quot; title=&quot;动态导入，ECMAScript import() 提案&quot;&gt;&lt;/a&gt;动态导入，ECMA
      
    
    </summary>
    
    
    
      <category term="ECMAScript" scheme="https://blog.esonwong.com/tags/ECMAScript/"/>
    
      <category term="懒加载" scheme="https://blog.esonwong.com/tags/%E6%87%92%E5%8A%A0%E8%BD%BD/"/>
    
      <category term="import" scheme="https://blog.esonwong.com/tags/import/"/>
    
      <category term="vue" scheme="https://blog.esonwong.com/tags/vue/"/>
    
      <category term="webpack" scheme="https://blog.esonwong.com/tags/webpack/"/>
    
  </entry>
  
</feed>
